# 连接池设计笔记

## 基本要素

1. 能进行复用连接, 确保连接状态良好;
2. 获取连接时具备线程安全;
3. 配置池的大小, 具备伸缩性; 超出可连接数量, 能处于连接等待排队状态;

## 协程池

### 设计思考

1. 抑制无限制生成go协程; 控制好系统内的协程数量; 涉及信号量(限制可同时运行的协程数量);

2. 避免协程的不断生成与回收;

3. 协程池与对象池(连接池等)区别: 不能放回去再取出来。

4. goroutine应该是一直运行着的。需要的时候就运行，不需要的时候就阻塞；对其他的goroutine的调度影响也不是很大。而goroutine的任务可以通过channel来传递；

### 易引发问题

1. 高并发时, 复用连接池里, 原请求数据与旧请求数据易引发错乱

