# 服务端与客户端对断开TCP连接细节

## 长连接

http请求是请求应答式的，当每个请求都设置请求头与响应体的长度，那么我们是可以在一个连接上面执行多个请求的

## 发起断开请求的条件

#### Http1.0协议

- 响应头中有content-length头，则以content-length的长度就可以知道body的长度了，客户端在接收body时，就可以依照这个长度来接收数据，接收完后，就表示这个请求完成了，主动发起断开连接

- 没有content-length头，则客户端会一直接收数据，直到服务端主动断开连接，才表示body接收完了

#### Http1.1协议

- 响应头中的Transfer-encoding为chunked传输，则表示body是流式输出，body会被分成多个块，每块的开始会标识出当前块的长度，此时，body不需要通过长度来指定；非chunked传输，而且有content-length，则按照content-length来接收数据。完成数据接收, 客户端主动断开连接

- 如果是非chunked，并且没有content-length，则客户端接收数据，直到服务端主动断开连接。

## 总结

如果能够有办法知道服务器传来的长度，都是客户端首先断开。如果不知道就一直接收数据。知道服务端断开