# RST相关攻击

## 防火墙原理（GFW）

1. 监视互联网流量，当识别相关访问地址，主动进行关闭连接，对客户端与连接服务端发送RST

2. 主要方式：DNS污染，对指定的IP地址进行封锁

## RST攻击

1. 源端口和序列号是关键因素

2. 通过伪造重置段来过早关闭TCP连接；当接收方认证并通过重置段的码，则会关闭连接；当重置段码差异过大，则接收方会丢弃，从而无法成功关闭连接

### 预防RST

#### TCP的滑动窗口

1. 保证TCP的传输有效性，控制接收数据的速率；避免接收方的缓冲区被填满，再接收数据因无地方存储而被丢弃；

2. 伪造的RST的序列号需要在接收方的滑动窗口内，否则接收方会丢弃

## 正常触发RST信号

1. 对于异常及违反TCP传输协议的规则，都会触发发送RST信号

2. RST段关闭连接时，不必等缓冲区的数据都发送出去，直接丢弃缓冲区中的数据。而接收端收到RST段后，也不必发送ack来确认

### 触发RST信号情景

1. 连接一个未监听的端口，则被连接方会发送一个RST段

2. 向已关闭的socket发送数据

3. 向已关闭的连接发送FIN: 客户端在主动关闭连接里，未及时响应服务端的FIN, 而是直接关闭连接, 服务端会在FIN_WAIT2超时，b并发出RST

4. 向已经消逝的连接中发送数据; 消逝连接：当前这个连接状态操作系统已经不再维护，其数据结构内核已经注销。
