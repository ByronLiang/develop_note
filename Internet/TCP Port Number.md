# 最大可用端口数

## 情景

- 客户端/浏览器最多可访问多少个服务器地址

最多可访问65535; 每台服务器最多可提供65535个TCP端口; 若单一客户端请求服务器, 最多占用65535个请求

- 服务器TCP内核连接数优化配置: `net.core.somaxconn`

默认`net.core.somaxconn`是128; 此参数优化值，最大且有效值为`65535` 此数值是每台机器可提供的TCP连接数; 若设置数值大于65535是无意义的; 有效数值是小于等于65535

## 细节

1. TCP 与 UDP 分别都各有65535个端口号; TCP没有0值的端口号; UDP的0值端口号, 被称为连接不具备端口号

2. TCP/UDP报文里, 端口号(源端口/目标端口)是各占用16bit(2^16=65535) 因此，机器提供端口号数目就是65535

3. 为确保不占用端口号, 减少连接长期无法被关闭(TCP挥手阶段的TimeWait情景等)


