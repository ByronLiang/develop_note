# TCP高可用性笔记

## 半打开 半关闭 半连接状态

### 半连接

三次握手中，主动发起握手的一方不发最后一次ACK，使得服务器端阻塞在SYN_RECV状态

半连接攻击`(SYN攻击)`: 会耗尽服务器资源，使得真正的请求无法建立连接

### 半打开

一方异常关闭，而另一方并不知情。处于半打开的状态;需要在应用层引入心跳机制，以检测半打开状态，检测到了发送RST重新建立连接

### 半关闭

对应TCP四次挥手的 FIN_WAIT_2状态: 主动方发起FIN, 并且被动方返回ACK; 主动发不再发起数据传输; 但被动方仍进行数据传输

## TCP传输速率

### 滑动窗口

滑动窗口是来自接收方的控制发送速率的方式；

慢慢的从数据的左边移动到右边,把处于窗口范围内的数据发送出去(但不用发送所有,只是处于窗口内的数据可以发送）

若右侧边界向左，则呈现缩容

### 拥塞控制

慢启动来自发送方的控制数据传输速率的方式

TCP发送方首先发送一个数据报,然后等待对方的回应,得到回应后就把这个窗口的大小加倍,然后连续发送两个数据报,等到对方回应以后,再把这个窗口加倍；
随着发送次数增多，能发送更多的数据

基于上述现象, 应减少TCP新建的次数; 对于新建立的TCP连接，首阶段发送速率是比较低的

## 在应用层里进行提高UDP可靠性传输

传输层无法保证数据的可靠传输，只能通过应用层来实现了。实现的方式可以参照tcp可靠性传输的方式，只是实现不在传输层，实现转移到了应用层。

1. 提供超时重传，能避免数据报丢失。

2. 提供确认序列号，可以对数据报进行确认和排序。

